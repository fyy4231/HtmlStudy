##函数表达式

####函数表达式的特征

定义函数的方式有两种：一种是函数声明，一种是函数表达式；

1、函数声明：

```function fnName(arg0,arg1,---){ 函数体 }```

关于函数声明，他的一个重要特性就是**函数声明提升**，意思是执行代码前会先读取函数声明，就意味着可以把函数声明放到调用它的语句后面。如下：

```
sayHello();
function sayHello(){ alert("Hello!"); } 
```

这个例子不会出错，因为代码在执行之前会先读取函数声明。

2、函数表达式：

```var fnName = function(arg0,arg1,---){ 函数体 }```

这种形式看起来像是常规的变量赋值语句，即创建一个函数并将它赋值给变量，这种情况下创建的函数叫做**匿名函数**，函数表达式和其他表达式一样，在使用前必须先赋值，如果先调用就会导致错误。

```
sayHello();  //错误，函数还不存在
var sayHello = function(){ alert("Hello!"); } 
```

理解函数提升的关键，就是理解函数声明和函数表达式之间的区别。

#### 递归函数

递归函数是在一个函数通过名字调用自身的情况下构成的，如下一个经典的递归阶乘函数：

```
function factorial(num){
  if(num<=1){ return 1; }else{ return num*functorial(num-1); }
}
```

#### 闭包

不少开发者总是搞不清楚匿名函数和闭包这两个概念，因此经常混用。**闭包是指有权访问另一个函数作用域中的变量的函数**

创建闭包的常见方式有：

1、在一个函数内部创建另外一个函数，并且把这个函数return出去。

2、用函数为元素绑定事件，当事件发生时，还可以操作该函数中的变量。

特性：

可以读取其它函数内部的变量

让这些变量的值始终保持在内存中

```
function fnName(propertyName){
  return function(obj1,obj2){
    var value1 = obj1[propertyName];
    var value2 = obj2[propertyName];
  }
}
```



-------------------------------------------------------------


回调函数

如果把一个函数作为参数传递给另一个函数，这个函数就是回调函数。

例：

function A（）{……}

function B（fn）{ fn && fn() }

B(A)  函数A被称为函数B的回调函数

-----------------------------------------------------------

js单线程

JavaScript语言的一大特点就是单线程，

也就是说，同一个时间只能做一件事。

那么，为什么JavaScript不能有多个线程呢？这样能提高效率啊。

JavaScript的单线程，与它的用途有关。

作为浏览器脚本语言，JavaScript的主要用途是与用户互动，以及操作DOM。

这决定了它只能是单线程，否则会带来很复杂的同步问题。

比如，假定JavaScript同时有两个线程，一个线程在某个DOM节点上添加内容，另一个线程删除了这个节点，这时浏览器应该以哪个线程为准？

所以，为了避免复杂性，从一诞生，JavaScript就是单线程，这已经成了这门语言的核心特征，将来也不会改变。

-----------------------------------------------------------

js的同步与异步（synchronous/asynchronous）


单线程就意味着，所有任务需要排队，前一个任务结束，才会执行后一个任务。

如果前一个任务耗时很长，后一个任务就不得不一直等着。


如果排队是因为计算量大，CPU忙不过来，倒也算了，但是很多时候CPU是闲着的

因为IO设备（输入输出设备）很慢（比如Ajax操作从网络读取数据），不得不等着结果出来，再往下执行。

JavaScript语言的设计者意识到，这时主线程完全可以不管IO设备，挂起处于等待中的任务，先运行排在后面的任务。

等到IO设备返回了结果，再回过头，把挂起的任务继续执行下去。


于是，所有任务可以分成两种：

同步任务（synchronous），

在主线程上排队执行的任务，只有前一个任务执行完毕，才能执行后一个任务；


异步任务（asynchronous）

不进入主线程、而进入"任务队列"（task queue）的任务

只有"任务队列"通知主线程，某个异步任务可以执行了，该任务才会进入主线程执行。


js的异步主要有三部分:

事件响应

定时器（setInterval/setTimeout）

HTTP请求（ajax技术）


Javascript引擎解析是一个单线程的过程,浏览器无论在任何时候有且只有一个线程在运行Javascript程序


浏览器是多线程的,这些线程在内核控制下相互配合以保持同步。在处理js的异步上浏览器内核的实现可能有多个进程:

Javascript引擎线程

界面渲染线程

浏览器事件触发线程

HTTP请求线程

…… 

这些线程的名字为渲染引擎、网络、js解析器等

Javascript除了一个主线程外,还配有一个代码队列,这个队列用以存放定时器、HTTP请求、事件响应的回调

Javascript是代码自上而下执行的

当执行到定时器、或者发送HTTP请求、或者发生用户交互事件响应时，会自动触发对应事件(HTTP请求、事件响应),将回调函数储存到队列中。

Javascript执行完主线程代码后，会去执行任务队列，队列内这个时间点是否有代码要执行；如果有，则执行队列中的代码。

